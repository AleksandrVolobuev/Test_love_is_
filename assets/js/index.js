const questions = [
  {
    text: "Как часто ты говоришь маме 'Я тебя люблю'?",
    answers: [
      "Почти каждый день",
      "Иногда, когда есть повод",
      "Очень редко",
      "Никогда",
    ],
    scores: [3, 2, 1, 0],
  },
  {
    text: "Если мама попросит помочь по дому, ты:",
    answers: [
      "Сразу помогаю",
      "Помогаю, но неохотно",
      "Откладываю, но потом делаю",
      "Придумываю отговорки",
    ],
    scores: [3, 2, 1, 0],
  },
  {
    text: "Если у мамы плохое настроение, ты:",
    answers: [
      "Стараюсь ее поддержать",
      "Не мешаю и жду",
      "Не обращаю внимания",
      "Раздражаюсь и ухожу",
    ],
    scores: [3, 2, 1, 0],
  },
  {
    text: "Как ты поздравляешь маму с праздниками?",
    answers: [
      "Готовлю подарок и сюрприз",
      "Просто поздравляю словами",
      "Жду, когда кто-то напомнит",
      "Иногда вообще забываю",
    ],
    scores: [3, 2, 1, 0],
  },
  {
    text: "Как ты реагируешь, если мама долго разговаривает с тобой?",
    answers: [
      "Внимательно слушаю",
      "Слушаю, но иногда отвлекаюсь",
      "Отвечаю односложно",
      "Говорю, что занят(а)",
    ],
    scores: [3, 2, 1, 0],
  },
  {
    text: "Ты делаешь что-то хорошее для мамы без просьбы?",
    answers: ["Да, часто", "Иногда", "Редко", "Никогда"],
    scores: [3, 2, 1, 0],
  },
  {
    text: "Если мама болеет, ты:",
    answers: [
      "Забочусь о ней",
      "Спрашиваю, как она себя чувствует",
      "Не обращаю внимания",
      "Думаю, что это не мое дело",
    ],
    scores: [3, 2, 1, 0],
  },
  {
    text: "Ты злишься на маму, если она делает замечания?",
    answers: ["Нет", "Иногда", "Часто", "Очень злюсь"],
    scores: [3, 2, 1, 0],
  },
  {
    text: "Как ты относишься к маминым советам?",
    answers: [
      "Прислушиваюсь",
      "Иногда слушаю",
      "Чаще игнорирую",
      "Думаю, что она не права",
    ],
    scores: [3, 2, 1, 0],
  },
  {
    text: "Если мама устала, ты:",
    answers: [
      "Предлагаю помощь",
      "Стараюсь не беспокоить",
      "Не замечаю",
      "Требую внимания",
    ],
    scores: [3, 2, 1, 0],
  },
  {
    text: "Ты радуешься, когда мама счастлива?",
    answers: ["Очень", "Иногда", "Не задумывался(ась)", "Мне все равно"],
    scores: [3, 2, 1, 0],
  },
  {
    text: "Как часто ты благодаришь маму за заботу?",
    answers: ["Очень часто", "Иногда", "Редко", "Никогда"],
    scores: [3, 2, 1, 0],
  },
  {
    text: "Ты поддерживаешь маму, если у нее проблемы?",
    answers: [
      "Стараюсь помочь",
      "Иногда",
      "Не люблю такие разговоры",
      "Не мое дело",
    ],
    scores: [3, 2, 1, 0],
  },
  {
    text: "Если мама попросит сделать что-то важное, ты:",
    answers: [
      "Выполняю сразу",
      "Делаю, но не сразу",
      "Откладываю",
      "Отказываюсь",
    ],
    scores: [3, 2, 1, 0],
  },
  {
    text: "Как ты относишься к маминым просьбам?",
    answers: [
      "Стараюсь выполнять",
      "Выполняю, если удобно",
      "Часто игнорирую",
      "Считаю, что она просит много",
    ],
    scores: [3, 2, 1, 0],
  },
];

const gameMusic = document.querySelector(".gameMusic");
gameMusic.volume = 0.5; // Громкость музыки

let isMusicStarted = false; // Флаг для отслеживания запуска музыки

// Функция для запуска музыки
function startMusic() {
  if (!isMusicStarted) {
    gameMusic.play();
    isMusicStarted = true;
  }
}

// Функция обновления сообщения о текущем ходе
let currentQuestion = 0;

// Счетчик баллов
let score = 0;

// Контейнер, в котором отображаются вопросы и варианты ответов
const quizContainer = document.querySelector(".quiz");

// Кнопка "Следующий вопрос"
const nextButton = document.querySelector(".nextButton");
nextButton.addEventListener("click", nextQuestion);

// Функция для отображения текущего вопроса
function showQuestion() {
  // Получаем текущий вопрос из массива questions
  const q = questions[currentQuestion];

  // Заполняем контейнер текстом вопроса
  quizContainer.innerHTML = `<p>${q.text}</p>`;

  // Перебираем все возможные ответы на вопрос
  q.answers.forEach((answer, i) => {
    // Добавляем радиокнопку для каждого ответа с его значением (баллом)
    quizContainer.innerHTML += `<label>
          <input type='radio' name='answer' value='${q.scores[i]}'> ${answer}
      </label><br><br>`;
  });
}

// Функция обработки ответа и перехода к следующему вопросу
function nextQuestion() {
  startMusic(); // Запускаем музыку при первом нажатии

  const selected = document.querySelector("input[name='answer']:checked");
  if (selected) {
    score += parseInt(selected.value);
    currentQuestion++;

    if (currentQuestion < questions.length) {
      showQuestion();
    } else {
      showResult();
    }
  }
}

// Функция для показа итогового результата теста
function showResult() {
  // Определяем результат в зависимости от количества набранных баллов
  let resultText =
    score >= 40
      ? "Ты очень любишь свою маму! Можно телефон на час"
      : score >= 30
      ? "Ты любишь маму, но иногда забываешь об этом. Можно телефон по разрешении мамы."
      : score >= 15
      ? "Ты мог бы быть внимательнее к маме. Телефон нельзя."
      : "Попробуй больше заботиться о маме. Забудь о телефоне на неделю";

  // Выводим результат на экран
  quizContainer.innerHTML = `<p class='result'>${resultText}</p>`;

  // Изменяем текст кнопки на "Пройти тест еще раз"
  nextButton.textContent = "Пройти тест еще раз";
  
  // Убираем обработчик для перехода к следующему вопросу
  nextButton.removeEventListener("click", nextQuestion);
  
  // Добавляем обработчик для сброса теста
  nextButton.addEventListener("click", resetTest);
}

// Функция для сброса теста
function resetTest() {
  score = 0;
  currentQuestion = 0;
  nextButton.textContent = "Ответить";
  showQuestion();
  
  // Убираем обработчик для сброса теста
  nextButton.removeEventListener("click", resetTest);
  
  // Восстанавливаем обработчик для "Следующего вопроса"
  nextButton.addEventListener("click", nextQuestion);
}

// Запускаем первый вопрос
showQuestion();
